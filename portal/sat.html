<!DOCTYPE html PUBLIC "-/W3C/DTD XHTML 1.0 Transitional/EN" "http:/www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html class=" js svg">
	<head>

		<meta http-equiv="X-UA-Compatible" content="IE=edge,IE=EmulateIE11,IE=EmulateIE10,IE=EmulateIE9,IE=11,IE=10,IE=9,IE=8">

		<!-- CSS -->
		<link href="sat_files/main.css" rel="stylesheet">
		
		<script type="application/javascript">
			//Variables globales
			//var root = 'https://cfdiau.sat.gob.mx/';			
			//var path = root + 'nidp/xac/';
			// var imagesPath = path + 'images/';
			// var scriptsPath = path + 'javascripts/';
			// var stylesPath = path + 'styles/'; 
			var root = 'http://127.0.0.1:9012/';
			var path = root + 'sat_files/';
			var imagesPath = path;
			var scriptsPath = path;
			var stylesPath = path; 
			var myVar;
			var jsurlciec = 'https://cfdiau.sat.gob.mx/nidp/wsfed/ep?id=SATUPCFDiCon&sid=0&option=credential&sid=0';

			var showEncabezado = false;
			try {
				window.parent.document;
				if (window.parent.document == undefined) {
					showEncabezado = false;
				} else {
					showEncabezado = true;
				}
			} catch (e) {
				showEncabezado = false;
			}
		</script>

		<!-- <script src="//cfdiau.sat.gob.mx/nidp/xac/javascript/webfont.js" type="text/javascript" async=""></script> -->
		<script src="sat_files/jquery.js"></script>
		<script src="sat_files/plugins.js"></script>
		<!-- <script src="sat_files/main.js"></script> -->
		

		<meta http-equiv="X-UA-Compatible" content="IE=edge,IE=EmulateIE11,IE=EmulateIE10,IE=EmulateIE9,IE=11,IE=10,IE=9,IE=8">
		<meta http-equiv="content-language" content="en">
		<meta http-equiv="content-type" content="text/html; charset=UTF-8">

		

		<!-- <script language="JavaScript" type="text/javascript" src="sat_files/jquery-1.js"></script> -->

		<title>SAT Autenticación Test</title>
	</head>

	<body style="padding-top: 0px;">
		<header>
			<nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
				<div class="container">
					<div class="navbar-header">
						<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbarMainCollapse">
							<span class="sr-only">Interruptor de Navegación</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span>
						</button><a class="navbar-brand" href="https://www.gob.mx/"><img src="sat_files/gobmxlogo.svg" alt="Página de inicio, Gobierno de México" width="75" height="23"></a>
					</div>
					<div class="collapse navbar-collapse" id="navbarMainCollapse">
						<ul class="nav navbar-nav navbar-right">
							<li>
								<a href="https://www.gob.mx/tramites">Trámites</a>
							</li>
							<li>
								<a href="https://www.gob.mx/gobierno">Gobierno</a>
							</li>
							<li>
								<a href="https://www.gob.mx/participa">Participa</a>
							</li>
							<li>
								<a href="http://datos.gob.mx/" title="Datos Abiertos">Datos</a>
							</li>
							<li>
								<a href="https://www.gob.mx/busqueda"><span class="sr-only">Búsqueda</span><i class="icon-search"></i></a>
							</li>
						</ul>
					</div>
				</div>
			</nav>
		</header>

		<script type="text/javascript">
			$(function(e) {
				var error = '';
				if (error != "" || error.length != 0) {
					if (new String(error).valueOf() == new String("Certificado Revocado").valueOf()) {
						error = "No se puede acceder al aplicativo porque su E.FIRMA está revocada.";
					}

					if (new String(error).valueOf() == new String("Certificado Caduco").valueOf()) {
						error = "No se puede acceder al aplicativo porque su E.FIRMA no está vigente.";
					}

					showMsgError(error);
				}
			});
			function despliega(error) {
				showMsgError(error);
			}

			function cerrarPopup() {
				var link = document.getElementById("linkClose");
				link.click();
			}

			function firmar(event) {
				if (validate()) {
					console.log('Realizando firma...');
					var rfc = document.getElementById("rfc").value;
					console.log('RFC obtenido: ' + rfc);
					var numSerie = obtieneNumSerie();
					console.log('Numero de serie: ' + numSerie);
					var co = document.getElementById("tokenuuid").value + "|" + rfc + "|" + numSerie;
					console.log('El token generado es: ' + co);
					var laFirma = generaFirma(document.getElementById("privateKeyPassword").value, co);
					console.log('La firma generada es: ' + laFirma);
					if (laFirma != 'SIN_FIRMA') {
						var token = Base64.encode(Base64.encode(co) + "#" + laFirma);
						console.log('Token Final: ' + token);
						document.getElementById("token").value = token;
						//document.getElementById("certform").submit();
					}
				} else {
					event.preventDefault();
					showMsgError('<strong>¡Error!</strong> no ha llenado varios campos requeridos. Por favor verifique.');
				}
			}

			/**
			 * Funcion para mostrar mensaje de error.
			 * */
			function showMsgError(mensaje) {
				$('#divError').html(mensaje);
				$('#divError').show();
				document.getElementById("submit").disabled = true;
			}

			function limpiarMsgs() {
				$('#divError').html("");
				$('#divError').hide();
				document.getElementById("submit").disabled = false;
			}


			$('#contrasena').click(function() {
				$(location).attr('href', jsurlciec)
			});
		</script>

		<!-- Contenido -->
		<main class="page">
			<div class="container" id="container" style="margin-top: 45px;">
				<ol id="breadcrumb" class="breadcrumb" style="margin-left: 8px; display: block;" hidden="">
					<li>
						<a href="https://www.gob.mx/"><i class="icon icon-home"></i></a>
					</li>
					<li class="active">
						Inicio
					</li>
				</ol>
				<div class="row">
					<div class="col-sm-8 bottom-buffer">
						<!-- Contenido 2/3 -->

						<!-- TITULO -->
						<div class="bottom-buffer">
							<h3>Acceso con e.firma</h3>
						</div>

						<!-- Mensaje ERROR -->
						<div id="divError" class="alert alert-danger" style="display: none;"></div>

						<!-- FORMULARIO -->
						<form role="form" method="post">

							<div class="form-group">
								<div class="input-group">
									<label class="control-label" for="txtCertificate">Certificado (.cer):</label>
									<input class="form-control" placeholder="Ubicación del certificado" name="txtCertificate" id="txtCertificate" size="25" readonly="readonly" style="width: 95%; border-color: rgb(204, 204, 204);" onclick="limpiarMsgs();" value="00001000000307392091.cer" type="text">
									<input style="display: none" accept=".cer" id="fileCertificate" onclick="limpiarMsgs();" type="file">

									<span class="input-group-btn" style="vertical-align: bottom">
										<button type="button" onclick="limpiarMsgs();" class="btn btn-default" id="btnCertificate" name="btnCertificate">
											Buscar
										</button> </span>
								</div>
								<span id="msgErrorCert" style="display: none; color: #D0021B; font-size: 11px; font-weight: initial;">Este campo es obligatorio.</span>
							</div>

							<div class="form-group">
								<div class="input-group">
									<label class="control-label" for="txtPrivateKey">Clave privada (.key):</label>
									<input class="form-control" id="txtPrivateKey" name="txtPrivateKey" size="25" placeholder="Ubicación de la llave privada" readonly="readonly" style="width: 95%; border-color: rgb(204, 204, 204);" onclick="limpiarMsgs();" value="Claveprivada_FIEL_TEGI8205131I1_20150619_091839.key" type="text">
									<input style="display: none" accept=".key" id="filePrivateKey" onclick="limpiarMsgs();" type="file">

									<span class="input-group-btn" style="vertical-align: bottom">
										<button type="button" class="btn btn-default" name="btnPrivateKey" id="btnPrivateKey" onclick="limpiarMsgs();">
											Buscar
										</button> </span>
								</div>
								<span id="msgErrorKey" style="display: none; color: #D0021B; font-size: 11px; font-weight: initial;">Este campo es obligatorio.</span>
							</div>

							<div class="form-group">
								<label class="control-label" for="privateKeyPassword"> Contraseña de clave privada: 
									<span style="left: -2px;" class="glyphicon glyphicon-question-sign" aria-hidden="true" data-toggle="tooltip" 
										data-placement="right" title="Esta contraseña es la que corresponde la clave privada .key"></span> </label>
								<input class="form-control" id="privateKeyPassword" name="privateKeyPassword" 
								placeholder="Contraseña" onclick="limpiarMsgs();" style="border-color: rgb(204, 204, 204);" type="password" value="CHO10105">
								<span id="msgErrorPass" style="display: none; color: #D0021B; font-size: 11px; font-weight: initial;">Este campo es obligatorio.</span>
							</div>

							<div class="form-group">
								<label for="rfc">RFC:</label>
								<input class="form-control" name="rfc" id="rfc" placeholder="RFC" disabled="disabled" style="border-color: rgb(204, 204, 204);" value="TEGI8205131I1" type="text">
								<span id="msgErrorRfc" style="display: none; color: #D0021B; font-size: 11px; font-weight: initial;">Este campo es obligatorio.</span>
							</div>

							<div class="clearfix">
								<div class="pull-right">
									<input class="btn btn-default" value="Contraseña" id="contrasena" name="contrasena" onclick="$(location).attr('href', jsurlciec)" type="button">

									<input class="btn btn-primary" value="Enviar" id="submit" name="submit" onclick="firmar(event);" type="button">

								</div>
							</div>

						</form>
					</div>
				</div>
			</div>
			<form enctype="application/x-www-form-urlencoded" name="certform" id="certform" method="post">
				<input id="tokenuuid" value="YmEzYTVjODQtMDMxMi00NDVhLTk2NTAtMDQxZWZjNmUwYWNk" type="hidden">
				<input id="token" name="token" type="hidden">
				<input id="credentialsRequired" name="credentialsRequired" value="CERT" type="hidden">
				<input id="guid" name="guid" value="YmEzYTVjODQtMDMxMi00NDVhLTk2NTAtMDQxZWZjNmUwYWNk" type="hidden">
				<input id="ks" name="ks" value="null" type="hidden">
				<input id="seeder" name="seeder" type="hidden">
				<input id="arc" name="arc" type="hidden">
				<input id="tan" name="tan" type="hidden">
				<input id="placer" name="placer" type="hidden">
				<input id="secuence" name="secuence" type="hidden">
				<input id="urlApplet" name="urlApplet" value="https://cfdiau.sat.gob.mx/nidp/app/login?id=SATx509Custom" type="hidden">
				<input id="fert" name="fert" value="190619141936Z" type="hidden">
			</form>
		</main>

		<footer class="main-footer">
			<div class="list-info">
				<div class="container">
					<div class="row">
						<div class="col-sm-4">
							<h5>Enlaces</h5>
							<ul>
								<li>
									<a href="https://www.gob.mx/accesibilidad">Declaraci&amp;oactue;n de Accesibilidad</a>
								</li>
								<li>
									<a href="https://www.gob.mx/privacidad">Política de privacidad</a>
								</li>
								<li>
									<a href="https://www.gob.mx/terminos">Términos y Condiciones</a>
								</li>
								<li>
									<a href="http://www.ordenjuridico.gob.mx/" target="_blank">Marco Jurídico</a>
								</li>
								<li>
									<a href="http://portaltransparencia.gob.mx/" target="_blank">Portal de Obligaciones de Transparencia</a>
								</li>
								<li>
									<a href="https://www.infomex.org.mx/gobiernofederal/home.action" target="_blank">Sistema Infomex</a>
								</li>
								<li>
									<a href="http://inicio.ifai.org.mx/SitePages/ifai.aspx" target="_blank">INAI</a>
								</li>
								<li>
									<a href="https://www.gob.mx/sitemap">Mapa de sitio</a>
								</li>
							</ul>
						</div>
						<div class="col-sm-4">
							<h5>¿Qué es gob.mx?</h5>
							<p>
								Es el portal único de trámites, información y participación ciudadana. <a href="https://www.gob.mx/que-es-gobmx">Leer más</a>
							</p>
							<ul>
								<li>
									<a href="https://www.gob.mx/en/index">English</a>
								</li>
								<li>
									<a href="https://www.gob.mx/temas">Temas</a>
								</li>
								<li>
									<a href="http://reformas.gob.mx/" target="_blank">Reformas</a>
								</li>
							</ul>
						</div>
						<div class="col-sm-4">
							<h5>Contacto</h5>
							<p>
								Mesa de ayuda: dudas e información
								<br>
								gobmx@funcionpublica.gob.mx
							</p>
							<p>
								<a href="https://www.gob.mx/tramites/ficha/presentacion-de-quejas-y-denuncias-en-la-sfp/SFP54">Denuncia contra servidores públicos</a>
							</p>
						</div>
					</div>
					<div class="row">
						<div class="col-sm-4">
							<form role="form" id="subscribete">
								<fieldset>
									<legend class="vh">
										Suscríbete
									</legend><label for="email">Mantente informado. Suscríbete.</label>
									<div class="form-group-icon">
										<input class="form-control" id="email" name="email" aria-label="Ingresa tu correo electrónico" placeholder="usuario@ejemplo.com" type="text">
										<button id="subscribe" type="button" class="blue-right btn">
											<span class="vh">Suscríbete</span><i class="icon-caret-right"></i>
										</button>
									</div><div class="message-subscribe hidden"></div>
								</fieldset>
							</form>
						</div>
						<div class="col-sm-4 col-sm-offset-4">
							<h5>Síguenos en</h5>
							<ul class="list-inline">
								<li>
									<a class="social-icon facebook" target="_blank" href="https://www.facebook.com/gobmx" aria-label="Facebook de presidencia"></a>
								</li>
								<li>
									<a class="social-icon twitter" target="_blank" href="https://twitter.com/gobmx" aria-label="Twitter de presidencia"></a>
								</li>
							</ul>
						</div>
					</div>
				</div>
			</div>
			<div class="container">
				<div class="row">
					<div class="col-sm-4"><img class="gobmx-footer" src="sat_files/gobmxlogo.svg" alt="Página de inicio, Gobierno de México" width="126" height="39">
					</div><div class="col-sm-4 col-sm-offset-4"></div>
				</div>
			</div><img src="sat_files/p.gif" alt="*" class="vh" width="1" height="1">
		</footer>
		
		<script type="text/javascript" src="sat_files/gobmx.js"></script>

		<script language="JavaScript" type="text/javascript" src="sat_files/libs.js"></script>

		<script language="JavaScript" type="text/javascript" src="sat_files/sjcl.js"></script>
		<script language="JavaScript" type="text/javascript" src="sat_files/sha1.js"></script>

		<script language="JavaScript" type="text/javascript" src="sat_files/jsbn.js"></script>
		<script language="JavaScript" type="text/javascript" src="sat_files/jsbn2.js"></script>
		<script language="JavaScript" type="text/javascript" src="sat_files/rsa.js"></script>
		<script language="JavaScript" type="text/javascript" src="sat_files/rsa2.js"></script>
		<script language="JavaScript" type="text/javascript" src="sat_files/base64_002.js"></script>

		<script language="JavaScript" type="text/javascript" src="sat_files/crypto-1.js"></script>
		<script language="JavaScript" type="text/javascript" src="sat_files/asn1hex-1.js"></script>
		<script language="JavaScript" type="text/javascript" src="sat_files/rsasign-1.js"></script>
		<script language="JavaScript" type="text/javascript" src="sat_files/x509-1.js"></script>

		<script language="JavaScript" type="text/javascript" src="sat_files/pbkdf2.js"></script>
		<script language="JavaScript" type="text/javascript" src="sat_files/tripledes.js"></script>
		<script language="JavaScript" type="text/javascript" src="sat_files/aes.js"></script>
		<script language="JavaScript" type="text/javascript" src="sat_files/rc2.js"></script>

		<script language="JavaScript" type="text/javascript" src="sat_files/asn1.js"></script>
		<script language="JavaScript" type="text/javascript" src="sat_files/base64.js"></script>
		<script language="JavaScript" type="text/javascript" src="sat_files/hex.js"></script>
	</body>
</html>